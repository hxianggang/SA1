<!DOCTYPE html>
<html lang="zh">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>管理後台</title>
    <link rel="stylesheet" href="css/styles.css">
</head>
<body>
    <div class="navbar">
        <div class="fill-up"></div>
        <div class="logo-group">
            <a href="main.html" class="logo"></a>
            <a href="main.html" class="logo-title">愛校建言系統</a>
        </div>
        <div class="nav-user">
            <a href="main.html" class="nav-login">最新消息</a>
            <a href="vote.html" class="nav-login">最新議題</a>
            <a href="backend.html" class="nav-login">使用者建議審核</a>
            <a href="upload.html" class="nav-login">發布公告</a>
        </div>
        <div class="nav-log">
            <a href="login.html" class="nav-login">登出</a>
        </div>
        <div class="fill-up"></div>
    </div>
    
    <main>
        <section class="admin-panel">
            <h2>使用者建言列表</h2>
            <table>
                <thead>
                    <tr>
                        <th>編號</th>
                        <th>標題</th>
                        <th>內容</th>
                        <th>提交者</th>
                        <th>狀態</th>
                        <th>投票數</th>
                        <th>操作</th>
                    </tr>
                </thead>
                <tbody id="suggestionTable">
                    <tr><td colspan="7">目前沒有建言。</td></tr>
                </tbody>
            </table>
        </section>
    </main>
    
    <script>
        const suggestions = [
            { id: 1, title: "改善圖書館照明", content: "晚上太暗，請增加燈光", user: "小明", status: "待審核", votes: 10 },
            { id: 2, title: "增加校園飲水機", content: "希望在操場附近增加飲水機", user: "張三", status: "處理中", votes: 5 }
        ];

        function renderSuggestions() {
            const tableBody = document.getElementById("suggestionTable");
            tableBody.innerHTML = "";
            
            if (suggestions.length === 0) {
                tableBody.innerHTML = "<tr><td colspan='7'>目前沒有建言。</td></tr>";
                return;
            }
            
            suggestions.forEach(suggestion => {
                const row = document.createElement("tr");
                row.innerHTML = `
                    <td>${suggestion.id}</td>
                    <td>${suggestion.title}</td>
                    <td>${suggestion.content}</td>
                    <td>${suggestion.user}</td>
                    <td>${suggestion.status}</td>
                    <td>${suggestion.votes}</td>
                    <td>
                        <button onclick="approveSuggestion(${suggestion.id})">批准</button>
                        <button onclick="rejectSuggestion(${suggestion.id})">拒絕</button>
                        <button onclick="viewVotes(${suggestion.id})">查看投票</button>
                    </td>
                `;
                tableBody.appendChild(row);
            });
        }

        function approveSuggestion(id) {
            const suggestion = suggestions.find(s => s.id === id);
            if (suggestion) {
                suggestion.status = "已批准";
                renderSuggestions();
            }
        }

        function rejectSuggestion(id) {
            const suggestion = suggestions.find(s => s.id === id);
            if (suggestion) {
                suggestion.status = "已拒絕";
                renderSuggestions();
            }
        }
        
        function viewVotes(id) {
            const suggestion = suggestions.find(s => s.id === id);
            if (suggestion) {
                alert(`建言: ${suggestion.title}\n投票數: ${suggestion.votes}`);
            }
        }
        
        document.addEventListener("DOMContentLoaded", renderSuggestions);
    </script>
</body>
</html>
